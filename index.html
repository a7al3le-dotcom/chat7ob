<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø³ÙŠÙ†Ù…Ø§ â€” Ø³ØªØ§ÙŠÙ„ Discord</title>
<style>
body {
    margin: 0;
    padding: 0;
    direction: rtl;
    font-family: 'Segoe UI', sans-serif;
    background: #2f3136;
    color: #fff;
}

.layout {
    display: flex;
    flex-direction: row;
    height: 100vh;
}

/* ====== Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ====== */
.sidebar {
    width: 220px;
    background: #202225;
    padding: 15px;
    overflow-y: auto;
    border-left: 2px solid #18191c;
    transition: transform 0.3s ease;
}

.sidebar h3 {
    font-size: 16px;
    margin-bottom: 15px;
    color: #b9bbbe;
}

.channel {
    padding: 10px;
    margin-bottom: 8px;
    background: #2f3136;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.2s;
}
.channel:hover { background: #36393f; }
.channel.active { background: #5865f2; }

/* Ø²Ø± toggle Ù„Ù„Ø¬ÙˆØ§Ù„ */
.toggle-btn {
    display: none;
    position: absolute;
    top: 10px;
    right: 10px;
    background: #5865f2;
    color: #fff;
    border: none;
    padding: 10px 12px;
    border-radius: 5px;
    cursor: pointer;
    z-index: 10;
}

.content {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: #36393f;
}

video {
    width: 100%;
    max-height: 40vh;
    background: black;
}

.chat-box {
    flex: 1;
    overflow-y: auto;
    padding: 10px 20px;
}

.msg {
    width: 100%;
    padding: 6px 0;
    border-bottom: 1px solid #202225;
    font-size: 14px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.msg .text-container {
    display: flex;
    gap: 6px;
    overflow: hidden;
    flex: 1;
    white-space: nowrap;
    text-overflow: ellipsis;
}

.msg .name {
    font-weight: bold;
    color: #4aa8ff;
    text-shadow: 1px 1px 2px #00000088;
    font-size: 14px;
}

.msg .text {
    color: #ffffff;
    font-size: 14px;
    overflow: hidden;
    text-overflow: ellipsis;
}

.msg .meta {
    white-space: nowrap;
    display: flex;
    gap: 8px;
}

.msg .time {
    color: #bbbbbb;
    font-size: 12px;
}

.input-area {
    display: flex;
    background: #40444b;
    padding: 10px;
    border-top: 2px solid #202225;
}

.input-area input {
    flex: 1;
    padding: 12px;
    border-radius: 5px;
    border: none;
    outline: none;
    background: #303339;
    color: white;
    font-size: 14px;
}

button {
    margin-right: 8px;
    padding: 12px 14px;
    border: none;
    border-radius: 5px;
    background: #5865f2;
    color: white;
    cursor: pointer;
    font-size: 14px;
}
button:hover { background: #4752c4; }

/* ======= Responsive ======= */
@media (max-width: 768px) {
    .layout {
        flex-direction: column;
    }

    .sidebar {
        position: absolute;
        top: 0;
        right: 0;
        height: 100%;
        transform: translateX(100%);
        z-index: 9;
    }

    .sidebar.show {
        transform: translateX(0);
    }

    .toggle-btn {
        display: block;
    }

    video {
        max-height: 30vh;
    }

    .msg .name {
        font-size: 13px;
    }
    .msg .text {
        font-size: 13px;
    }
    .msg .time {
        font-size: 11px;
    }
    .input-area input {
        font-size: 13px;
    }
    button {
        font-size: 13px;
        padding: 10px 12px;
    }
}
</style>
</head>
<body>

<button class="toggle-btn" onclick="toggleSidebar()">â˜° Ø§Ù„Ù‚Ù†ÙˆØ§Øª</button>

<div class="layout">

    <div class="sidebar" id="sidebar">
        <div class="channel active" data-room="room1">ğŸ¬ Ù‚Ù†Ø§Ø© Ø§Ù„Ø³ÙŠÙ†Ù…Ø§</div>
        <div class="channel" data-room="room2">ğŸ’¬ Ø¯Ø±Ø¯Ø´Ø© 2</div>
        <div class="channel" data-room="room3">ğŸ”¥ Ø¯Ø±Ø¯Ø´Ø© 3</div>
    </div>

    <div class="content">
        <video controls src="movie.mp4"></video>
        <div class="chat-box" id="chatBox"></div>
        <div class="input-area">
            <input id="msgInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
            <button onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
      apiKey: "AIzaSyDAxLtHcIDePIeT--h9bS-yTz7OYPxzTik",
      authDomain: "my-chat-app-1d0e8.firebaseapp.com",
      databaseURL: "https://my-chat-app-1d0e8-default-rtdb.firebaseio.com",
      projectId: "my-chat-app-1d0e8",
      storageBucket: "my-chat-app-1d0e8.firebasestorage.app",
      messagingSenderId: "602134283299",
      appId: "602134283299:web:2756df0a8d8beaaaea9d96"
    };

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ===== Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… =====
let username = "";
function askName() {
    username = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ:");
    if (!username || username.trim() === "") askName();
}
askName();

// ===== Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ© ÙˆÙˆÙ‚Øª Ø¹Ø±Ø¨ÙŠ =====
function toArabicNums(str) {
    return str.replace(/[0-9]/g, d => "Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©"[d]);
}
function formatArabicTime() {
    const date = new Date();
    let h = date.getHours();
    let m = date.getMinutes();
    let period = h >= 12 ? "Ù…" : "Øµ";
    h = h % 12;
    h = h || 12;
    m = m < 10 ? "0" + m : m;
    return toArabicNums(`${h}:${m} ${period}`);
}

let currentRoom = "room1";
const chatBox = document.getElementById("chatBox");
const sidebar = document.getElementById("sidebar");

document.querySelectorAll(".channel").forEach(ch => {
    ch.addEventListener("click", () => {
        document.querySelectorAll(".channel").forEach(c => c.classList.remove("active"));
        ch.classList.add("active");
        currentRoom = ch.getAttribute("data-room");
        loadMessages();

        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„
        if(window.innerWidth <= 768) {
            sidebar.classList.remove("show");
        }
    });
});

// ===== Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© =====
function sendMsg() {
    const msg = document.getElementById("msgInput").value.trim();
    if (!msg) return;
    db.ref("discord_style/" + currentRoom).push({
        name: username,
        text: msg,
        time: formatArabicTime()
    });
    document.getElementById("msgInput").value = "";
}

// ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ =====
function loadMessages() {
    chatBox.innerHTML = "";
    db.ref("discord_style/" + currentRoom).off();
    db.ref("discord_style/" + currentRoom).on("child_added", snap => {
        const data = snap.val();
        const bubble = document.createElement("div");
        bubble.className = "msg";
        bubble.innerHTML = `
            <div class="text-container">
                <span class="name">${data.name}</span>
                <span class="text">${data.text}</span>
            </div>
            <div class="meta">
                <span class="time">${data.time}</span>
            </div>
        `;
        chatBox.appendChild(bubble);
        chatBox.scrollTop = chatBox.scrollHeight;
    });
}

// ===== Ø²Ø± toggle Ù„Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ =====
function toggleSidebar() {
    sidebar.classList.toggle("show");
}

// ===== Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ± =====
document.getElementById("msgInput").addEventListener("keydown", function(e){
    if(e.key === "Enter") sendMsg();
});

loadMessages();
</script>

</body>
</html>
